<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <script src="js/auth.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sensor Gateway Dashboard</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" rel="stylesheet">
  
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

  <aside class="sidebar">
    <h1><i class="fas fa-tachometer-alt"></i> Dashboard</h1>

    <div class="nav-group">
      <div class="nav-group-title">Management</div>
      <div id="roomList" class="room-list"></div>
    </div>
    
    <div class="nav-group">
      <div class="nav-group-title">View Mode</div>
      <button onclick="loadCurrent()" class="secondary" id="realtimeBtn">Real-time</button>
      
      <button onclick="viewDailyChart()" id="dailyBtn">Daily Trend (Line)</button>
      <div id="daily-filter" style="display:none; margin-top: 10px;">
          <label for="viewDate">Select Day:</label>
          <input type="date" id="viewDate" onchange="viewDailyChart()">
      </div>
  
      <button onclick="viewMonthlyChart()" id="monthlyBtn">Monthly Min/Max</button>
      <div id="monthly-filter" style="display:none; margin-top: 10px;">
          <label for="viewMonth">Select Month:</label>
          <input type="month" id="viewMonth" onchange="viewMonthlyChart()">
      </div>
    </div>

    <div class="nav-group">
      <div class="nav-group-title">Settings</div>
      <label for="intervalInput">Interval (seconds):</label>
      <input type="number" id="intervalInput" value="5" min="1" />
      <div class="auto-update-toggle">
        <span>Auto-Update</span>
        <label class="switch">
          <input type="checkbox" id="autoUpdateToggle" onchange="toggleAutoUpdate(this.checked)" checked>
          <span class="slider"></span>
        </label>
      </div>
    </div>
    
<div class="sidebar-footer">
    <a href="admin.html" class="nav-item"><i class="fas fa-cog"></i> Advanced Config</a>
    <div class="nav-item" id="darkModeToggle">
        <i class="fas fa-moon"></i>
        <span>Dark Mode</span>
    </div>
    <button class="nav-item logout-btn" id="logoutButton"><i class="fas fa-sign-out-alt"></i> Logout</button>
</div>
  </aside>

  <main class="main-content">
    <header class="main-header">
      <h2 id="roomTitle">Select a room to begin</h2>
    </header>

    <div class="kpi-grid">
      <div class="kpi-card temperature">
          <div class="icon"><i class="fas fa-thermometer-half"></i></div>
          <div class="info">
              <h3>Temperature</h3>
              <p id="latestTemp">-- C</p>
              <small id="latestTempTime" class="kpi-timestamp">Last update: --</small>
          </div>
      </div>
      <div class="kpi-card humidity">
          <div class="icon"><i class="fas fa-tint"></i></div>
          <div class="info">
              <h3>Humidity</h3>
              <p id="latestHumidity">-- %</p>
              <small id="latestHumidityTime" class="kpi-timestamp">Last update: --</small>
          </div>
      </div>
      <div class="kpi-card light">
          <div class="icon"><i class="fas fa-sun"></i></div>
          <div class="info">
              <h3>Light</h3>
              <p id="latestLight">-- lux</p>
              <small id="latestLightTime" class="kpi-timestamp">Last update: --</small>
          </div>
      </div>
  </div>

    <div class="chart-grid" id="sensorCharts"></div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <script src="https://cdn.jsdelivr.net/npm/date-fns@2.29.3/index.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>

  <script src="js/app.js"></script>
  <script src="js/dashboard.js"></script>
</body>
</html>